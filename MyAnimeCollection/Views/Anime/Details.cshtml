@model Anime

@{
    ViewData["Title"] = Model.Title;
}

<!-- Anime Details -->
<div class="container">
    <h1 class="my-4">@Model.Title</h1>
    <div class="row">
        <div class="col-md-4">
            <img src="@Model.ImageURL" alt="@Model.Title" class="img-fluid" />
        </div>
        <div class="col-md-8">
            <h5>Gêneros:</h5>
            <ul>
                @foreach (var genre in Model.Genres)
                {
                    <li>@genre</li>
                }
            </ul>
            <h5>Número de Episódios: @Model.NumberEpisodes</h5>
            <h5>Sinopse:</h5>
            <p>@Model.Synopsis</p>

            <!-- Average Rating -->
            <h5>Média das Avaliações:</h5>
            <div class="average-rating" style="font-size: 1.5rem; color: gold;">
                @for (int i = 1; i <= 5; i++)
                {
                    @(i <= Math.Round(ViewBag.AverageRating) ? "★" : "☆")
                }
                <span style="color: black;">(@ViewBag.AverageRating.ToString("0.0") estrelas)</span>
            </div>

            <!-- Rating form -->
            <h5>Avaliar este Anime:</h5>
            <form asp-action="SubmitAvaliation" method="post">
                <input type="hidden" name="AnimeId" value="@Model.AnimeId" />
                <div class="rating" style="font-size: 1.5rem; color: gold;">
                    @for (int i = 1; i <= 5; i++)
                    {
                        <input type="radio" id="star-@i" name="Stars" value="@i" style="display: none;" />
                        <label for="star-@i" class="star" data-value="@i" style="cursor: pointer;">☆</label>
                    }
                </div>
                <button type="submit" class="btn btn-primary mt-2">Enviar Avaliação</button>
            </form>
        </div>
    </div>
</div>

<!-- Colors for the stars -->
<style>
    .star {
        font-size: 1.5rem;
        color: gray;
    }

    .star.filled {
        color: gold;
    }
</style>

<!-- Script to update the stars -->
<script>
    document.querySelectorAll('.rating').forEach(rating => {
        const stars = rating.querySelectorAll('.star');
        stars.forEach(star => {
            star.addEventListener('click', function () {
                const selectedValue = parseInt(this.getAttribute('data-value'));
                stars.forEach((s, index) => {
                    if (index < selectedValue) {
                        s.classList.add('filled');
                        s.textContent = '★';
                    } else {
                        s.classList.remove('filled');
                        s.textContent = '☆';
                    }
                });
            });
        });
    });
</script>
